function PetsHandler(){this.getPets=function(o,n){},this.postPet=function(o,n){}}angular.module("megabyte.funny-pets",[]).directive("appTitle",function(){return{restrict:"E",templateUrl:"partials/app-title.html"}}).directive("confirmationNeeded",function(){return{priority:1,terminal:!0,link:function(o,n,t){var e=t.confirmationNeeded||"Are you sure?",i=t.ngClick;n.bind("click",function(){$("#modal-confirm-text").html(e),$("#confirmation-modal").modal(),$("#modal-confirm-btn").unbind("click"),$("#modal-confirm-btn").on("click",function(){$("#confirmation-modal").modal("hide"),o.$eval(i)})})}}}),function(){function o(){t++,1===t&&$(".loader-frame").fadeIn()}function n(){t--,0===t&&$(".loader-frame").fadeOut()}var t=0;angular.module("megabyte.funny-pets").controller("BooksController",function(t,e,i,r,a){function d(){i.loggedIn&&(o(),t.get("/api/book?myBooks=1").then(function(o){n(),s.myBooks=o.data,s.myBooks.sort(function(o,n){if(o.borrowUserId){if(!n.borrowUserId)return-1;if(o.borrowApproved&&!n.borrowApproved)return 1;if(!o.borrowApproved&&n.borrowApproved)return-1}else if(n.borrowUserId)return 1;return 0}),s.approvNeedCount=s.myBooks.filter(function(o){return o.borrowUserId&&!o.borrowApproved}).length},n))}function l(){i.loggedIn&&(o(),t.get("/api/book?booksIWant=1").then(function(o){n(),s.wantBooks=o.data},n))}function c(){o(),t.get("/api/book").then(function(o){n(),s.allBooks=o.data},n)}function f(){$(".grid").css("width",""),$(".grid").masonry({itemSelector:".grid-item",columnWidth:210});var o=$(".grid").width(),n=210*Math.floor(o/210)+40;$(".grid").css("width",""+n+"px")}var u=a("UserController"),s=this;s.tab="all",s.showLoader=0,s.findedBooks=[],s.wantBooks=[],s.myBooks=[],s.allBooks=[],s.newNameChanged=function(){s.newName&&s.newName.length>2?(o(),t.get("/api/book?newBookName="+s.newName).then(function(o){n(),o.data&&o.data.length&&(s.findedBooks=o.data)},n)):s.findedBooks=[]},s.deleteBook=function(e){o(),t["delete"]("/api/book/"+e._id).then(function(o){d(),n()},n)},s.borrowBook=function(e){i.loggedIn?(o(),t.post("/api/book/"+e._id).then(function(o){c(),l(),n()},n)):u.loginClick()},s.returnBook=function(e){o(),t.get("/api/book/return/"+e._id).then(function(o){c(),l(),n()},n)},s.approveBook=function(e){o(),t.get("/api/book/approve/"+e._id).then(function(o){d(),n()},n)},s.refuseBook=function(e){o(),t.get("/api/book/refuse/"+e._id).then(function(o){d(),n()},n)},i.$watch("[loggedIn]",function(o,n){o?(d(),l()):s.myBooks=[]},!0),c(),s.clearSearch=function(){s.findedBooks=[],s.newName=""},s.clickFinded=function(e){s.findedBooks.splice(s.findedBooks.indexOf(e),1),o(),t.post("/api/book",{id:e.id}).then(function(o){d(),n()},n)},$(window).resize(f),f()})}();var Pet=require("../models/pet.js");module.exports=PetsHandler,function(){angular.module("megabyte.funny-pets").controller("UserController",function(o,n){var t=this;t.loginLink="/login",o.get("/auth/lastLoggedFrom").then(function(o){o.data.provider&&(t.loginLink="/auth/"+o.data.provider)}),o.get("/api").then(function(o){t.data=o.data,n.loggedIn=o.data.id}),t.loginClick=function(){window.location=$("#loginlink").attr("href")},$(".link-to-login").on("click",function(){t.loginClick()})})}();
//# sourceMappingURL=main.min.js.map
